---
title: "Les inégalités de genre dans la profession informatique"
author: "Elise Hodbert, Nolwenn Paquet, Victoria Bancel"
output: 
  flexdashboard::flex_dashboard:
    theme: bootstrap
    orientation: columns
    vertical_layout: fill
    navbar:
      - { title: "Moodle", href: "https://tice.agrocampus-ouest.fr/course/view.php?id=6726", align: left }
      - { icon: "fa-twitter", href: "https://twitter.com/marie_etienne", align: right }
      - { icon: "fa-linkedin", href: "https://www.linkedin.com/in/marie-etienne-818a7115/", align: right }
params:
  setup_path: ../resources/
---

<style>                     
.navbar {
  background-color:#46ACC8;
  border-color:#46ACC8;
}
.navbar-brand {
color:black!important;
}


</style>   


```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(ggplot2)
library(plotly)
library(ggplot2)
library("rnaturalearth")
library("rnaturalearthdata")
library(tidyverse)
library(maps)
library(ggrepel)
library(ggpubr)
library(scatterpie)
library(colorspace)

#importation des données
data2019 <- read.csv("~/GitHub/visualisation-nolwennvictoriaelise/archive/T Salary Survey EU 2019.csv", 
                     header = TRUE, 
                     sep = ";", 
                     encoding = "latin1")
data2019$City <- as.factor(data2019$City)
data2019$Gender <- as.factor(data2019$Gender)

library(stringr)
data2019$City = str_replace_all(data2019$City, pattern = "Braunschweig", replacement = "Brunswick")
data2019$City = str_replace_all(data2019$City, pattern = "DÃ¼sseldorf", replacement = "Dusseldorf")
data2019$City = str_replace_all(data2019$City, pattern = "Hannover", replacement = "Hanover")
data2019$City = str_replace_all(data2019$City, pattern = "Kassel ", replacement = "Kassel")
data2019$City = str_replace_all(data2019$City, pattern = "Marburg", replacement = "Magdeburg")
data2019$City = str_replace_all(data2019$City, pattern = "WÃ¼rzburg ", replacement = "Wurzburg")

villes= c("Berlin", "Bielefeld", "Brunswick", "Bremen", "Cologne", "Dusseldorf",
               "Darmstadt","Dresden", "Frankfurt", "Freiburg", "Hamburg",
               "Hanover", "Heidelberg","Ingolstadt", "Kaiserslautern",
               "Karlsruhe", "Kassel", "Koblenz", "Leipzig", "Lingen",
               "Magdeburg", "Munich", "Nuremberg", "Pforzheim", "Stuttgart", 
               "Wurzburg","Walldorf", "Wolfsburg")

data2019_Allemagne <- subset(data2019, City %in% villes) # on conserve seulement les villes en allemagne

dta <- subset(data2019_Allemagne, select=c("Age","Gender","City",
                                           "Seniority.level",
                                           "Position..without.seniority.",
                                           "Years.of.experience",
                                 "Yearly.brutto.salary..without.bonus.and.stocks."))
# on conserve seulement les variables d'interêt

colnames(dta) <- c("Age", "Gender", "City",
                   "Seniority_level",
                   "Position",
                   "Years_of_experience",
                   "Yearly_salary")





```

Column {.tabset .tabset-fade}
-----------------------------------------------------------------------

### Présentation de l'étude

Le [lien](https://www.asdcode.de/2020/01/it-salary-survey-december-2019.html) renvoie à l'étude sur laquelle se base notre exposé.

L'étude provient d'une enquête menée auprès de personnes travaillant dans le domaine de l'IT. Cette enquête a été menée en Allemagne, en 2019. 826 personnes y ont participé.

Dans notre exposé, nous nous interessons plus particuilièrement aux ingéalités qui existent entre les hommes et les femmmes, dans ce domaine de l'IT. Nous nous intéressons plus particuilièrement à trois inégalités : nombre de postes pourvus, salaires et positions au sein de l'entreprise.


### Nombre de postes pourvus

```{r  ggplotly, echo = FALSE,  eval = TRUE,  message = FALSE, warning=FALSE}
dta$City = as.factor(dta$City)

Germany <- map_data("world") %>% filter(region == "Germany")
Cities <- world.cities %>% filter(country.etc == "Germany")
Cities_allemagne <- Cities %>% filter(name %in% villes)
Cities_allemagne <- Cities_allemagne[-10,]

female = data.frame(table(dta$City[dta$Gender == "Female"]))
male = data.frame(table(dta$City[dta$Gender == "Male"]))
sum = female$Freq + male$Freq
dta_graph = data.frame(Cities_allemagne, Female = female$Freq, Male = male$Freq, sum = sum)
carte = ggplot() + 
  geom_polygon(data = Germany, aes(x = long, y = lat, group = group), 
               fill="grey",color="black", alpha = 0.5)+
  geom_text_repel(data = dta_graph, aes(x = long, y = lat, label = name), size = 3,   col = "black", family = "sans")+
  geom_point(data=dta_graph, aes(x = long, y = lat), color = "black", size = 1)+
  geom_scatterpie(data = dta_graph, 
                aes(x = long, y = lat,group = name, r = log(sum)/8),
                alpha =.6, cols = c("Female","Male"), color = NA)+
                scale_fill_manual(name = "Gender", values = c('#645A9F','#005D67'))+
  geom_scatterpie_legend(radius = log(dta_graph$sum)/8, x = 4, y = 47.5, 
                         labeller = function(x) round(exp(x*8), 0))+
  theme_void()+ 
  labs(title = "Repartition géographique des postes des participants de l'enquête",
     caption = "Source : Viktor Shcherban and Ksenia Legostay")+
  theme(
    plot.title = element_text(color = "black", size = 12, hjust = 0.5),
    plot.caption = element_text(color = "black", face = "italic", hjust = 1)
  )
carte
```



### Salaires

```{r}

```


### Positions au sein de l'entreprise

```{r}

```

